function selectText(e){var t,a=document;if(a.body.createTextRange)t=a.body.createTextRange(),t.moveToElementText(e),t.select();else if(window.getSelection){var o=window.getSelection();t=a.createRange(),t.selectNodeContents(e),o.removeAllRanges(),o.addRange(t)}}$(function(){function e(e,a,o){a=Math.max(0,a),a=Math.min(e.numCols-1,a),o=Math.max(1,o),o=Math.min(e.numRows,o),$(t).removeClass("active");var n=$(e).find(".c"+a+"r"+o);$(n).addClass("active"),t=n,e.lastPos=[n.data("col"),n.data("row")],$(e).find("input").val($(n).data("formula"))}var t;$(".spreadsheet").each(function(a){var o=this;o.numCols=$(o).data("columns"),o.numRows=$(o).data("rows"),o.lastPos=[0,1];var n=$(o).find("input");$(o).find("td").each(function(t){var a=this;$(a).on("click touch",function(){e(o,$(a).data("col"),$(a).data("row"))})}),$(o).on("blur",function(){$("td.active").removeClass("active"),$(n).val(""),t=null}),$(o).on("focus",function(){e(this,o.lastPos[0],o.lastPos[1])}),$(o).on("keydown",function(a){switch(a.keyCode){case 33:return e(this,$(t).data("col"),1),!1;case 34:return e(this,$(t).data("col"),o.numRows),!1;case 35:return e(this,o.numCols,$(t).data("row")),!1;case 36:return e(this,0,$(t).data("row")),!1;case 37:return e(this,$(t).data("col")-1,$(t).data("row")),!1;case 38:return e(this,$(t).data("col"),$(t).data("row")-1),!1;case 39:return e(this,$(t).data("col")+1,$(t).data("row")),!1;case 40:return e(this,$(t).data("col"),$(t).data("row")+1),!1;case 27:return $(this).blur(),!1}})})}),$(function(){function e(e){$(e).find(".selectonclick").on("click",function(){selectText(this)})}e("body");var t=$(window),a=$("#topbar");$(t).scrollTop()>380&&$(a).fadeIn(),$(t).scroll(function(){$(t).scrollTop()>380?$(a).fadeIn():$(a).fadeOut()});var o=$("#os").add("#os-top"),n=$("#software").add("#software-top"),c=$("#version").add("#version-top");$(n).on("change",function(){var e=$(this).val();"Excel for Mac"===e||"NeoOffice"===e?$(o).val("MacOS").attr("disabled",!0):"Excel for Windows"===e?$(o).val("Windows").attr("disabled",!0):$(o).attr("disabled",!1);var t=$("#version").val(),a={"Excel for Windows":["Excel 2016","Excel 2013","Excel 2010","Excel 2007"],"Excel for Mac":["Excel 2016","Excel 2015","Excel 2011","Excel 2008"],"LibreOffice/OpenOffice":["5.0.0","4.4.0","4.3.0","4.2.0","4.1.0","3.6.0"],"Google Sheets":[],NeoOffice:["NeoOffice 2015","NeoOffice 2014","NeoOffice 2013","NeoOffice 3.4"]}[e],n=a.length;a.indexOf(t)===-1&&(t=a[0]);for(var i="",s=0;s<n;s++)i+="<option",a[s]===t&&(i+=' selected="selected"'),i+=' value="'+a[s]+'">'+a[s]+"</option>";$(c).html(i),"Google Sheets"===e?$(c).attr("disabled",!0):$(c).attr("disabled",!1)}),$("form :input").on("change",function(){var e=$(this).data("pair");$("#"+e).val($(this).val())}),$("form :input").on("change",function(){var t=$(this).closest("form").serializeArray().reduce(function(e,t){return e[t.name]=t.value,e},{});$.ajax({url:"/content",contentType:"application/json",dataType:"json",type:"POST",processData:!1,data:JSON.stringify(t),success:function(t){for(var a in t){var o=$("section#"+a+" div.body");$(o).fadeOut(75,function(){$(this).html(t[$(this).data("slug")]),e(this)}).fadeIn(150)}}})})});